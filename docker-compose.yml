services:
  web:
    build:
      context: .
      dockerfile: Dockerfile.dev
    image: tool_test:dev
    ports:
      - "3000:3000"
    environment:
      - RAILS_ENV=development
      - RAILS_LOG_TO_STDOUT=1
    volumes:
      # Mount specific directories for live-reload and persistence
      - ./app:/rails/app
      - ./config:/rails/config
      - ./db:/rails/db
      - ./lib:/rails/lib
      - ./public:/rails/public
      - ./storage:/rails/storage
      - ./log:/rails/log
      - ./test:/rails/test
      - ./tmp:/rails/tmp
      - ./vendor:/rails/vendor
      - bundle_cache:/usr/local/bundle
    working_dir: /rails
    command: bash -lc "./bin/rails server -b 0.0.0.0 -p 3000"
    restart: unless-stopped

volumes:
  bundle_cache:

